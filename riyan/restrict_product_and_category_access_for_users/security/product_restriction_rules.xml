<odoo>
    <data>
        <record id="group_template_restriction" model="res.groups">
            <field name="name">Allow All Products &amp; Categories</field>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        </record>

        <!-- Restrict Product Access by Allowed Products -->
        <record id="product_template_restriction_rule" model="ir.rule">
            <field name="name">User can only access allowed products</field>
            <field name="model_id" ref="product.model_product_template"/>
            <field name="domain_force">[ '|','|', ('categ_id', 'in', user.allowed_category_ids.ids), ('categ_id', 'child_of', user.allowed_category_ids.ids), ('id', 'in', user.allowed_product_ids.ids) ]</field>
            <field name="groups" eval="[(4, ref('restrict_product_and_category_access_for_users.group_template_restriction'))]"/>
        </record>
    </data>
</odoo>
